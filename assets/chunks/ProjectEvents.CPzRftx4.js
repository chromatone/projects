import{_ as D,K as W,c as f,o as c,a as l,q as G,L as J,M as P,N as h,e as _,E as u,b as U,O as z,P as E,Q as q,F as b,G as B,T as F}from"./framework.CZbfKpy9.js";var y="/",V=(e,t)=>(e.endsWith(y)&&(e=e.slice(0,-1)),t.startsWith(y)||(t=y+t),e+t),H=(e,t,r)=>{let o=e.pathname===y?t:V(e.pathname,t),s=new globalThis.URL(o,e);if(r)for(let[n,i]of Object.entries(se(r)))if(i&&typeof i=="object"&&!Array.isArray(i))for(let[d,p]of Object.entries(i))s.searchParams.set(`${n}[${d}]`,String(p));else s.searchParams.set(n,i);return s};function I(e){return typeof e!="object"||!e?!1:"headers"in e&&"ok"in e&&"json"in e&&typeof e.json=="function"&&"text"in e&&typeof e.json=="function"}async function K(e){var t;if(!(typeof e!="object"||!e)){if(I(e)){let r=(t=e.headers.get("Content-Type"))==null?void 0:t.toLowerCase();if(r!=null&&r.startsWith("application/json")||r!=null&&r.startsWith("application/health+json")){let o=await e.json();if(!e.ok||"errors"in o)throw o;return"data"in o?o.data:o}if(r!=null&&r.startsWith("text/html")||r!=null&&r.startsWith("text/plain")){let o=await e.text();if(!e.ok)throw o;return o}return e.status===204?null:e}if("errors"in e)throw e;return"data"in e?e.data:e}}var Q=async(e,t,r=globalThis.fetch)=>(t.headers=typeof t.headers=="object"&&!Array.isArray(t.headers)?t.headers:{},r(e,t).then(o=>K(o).catch(s=>{let n={errors:s&&typeof s=="object"&&"errors"in s?s.errors:s,response:o};return s&&typeof s=="object"&&"data"in s&&(n.data=s.data),Promise.reject(n)}))),X=e=>t=>{let r=e;return{async getToken(){return r},async setToken(o){r=o}}},L={fetch:globalThis.fetch,WebSocket:globalThis.WebSocket,URL:globalThis.URL,logger:globalThis.console},Z=(e,t={})=>{let r=t.globals?{...L,...t.globals}:L;return{globals:r,url:new r.URL(e),with(o){return{...this,...o(this)}}}};function ee(e){return["directus_access","directus_activity","directus_collections","directus_comments","directus_fields","directus_files","directus_folders","directus_migrations","directus_permissions","directus_policies","directus_presets","directus_relations","directus_revisions","directus_roles","directus_sessions","directus_settings","directus_users","directus_webhooks","directus_dashboards","directus_panels","directus_notifications","directus_shares","directus_flows","directus_operations","directus_translations","directus_versions","directus_extensions"].includes(e)}var te=e=>{let t=(r,o=[])=>{if(typeof r=="object"){let s=[];for(let n in r){let i=r[n]??[];if(Array.isArray(i))for(let d of i)s.push(t(d,[...o,n]));else if(typeof i=="object")for(let d of Object.keys(i)){let p=i[d];for(let m of p)s.push(t(m,[...o,`${n}:${d}`]))}}return s.flatMap(n=>n)}return[...o,String(r)].join(".")};return e.flatMap(r=>t(r))},se=e=>{let t={};Array.isArray(e.fields)&&e.fields.length>0&&(t.fields=te(e.fields).join(",")),e.filter&&Object.keys(e.filter).length>0&&(t.filter=JSON.stringify(e.filter)),e.search&&(t.search=e.search),"sort"in e&&e.sort&&(t.sort=typeof e.sort=="string"?e.sort:e.sort.join(",")),typeof e.limit=="number"&&e.limit>=-1&&(t.limit=String(e.limit)),typeof e.offset=="number"&&e.offset>=0&&(t.offset=String(e.offset)),typeof e.page=="number"&&e.page>=1&&(t.page=String(e.page)),e.deep&&Object.keys(e.deep).length>0&&(t.deep=JSON.stringify(e.deep)),e.alias&&Object.keys(e.alias).length>0&&(t.alias=JSON.stringify(e.alias)),e.aggregate&&Object.keys(e.aggregate).length>0&&(t.aggregate=JSON.stringify(e.aggregate)),e.groupBy&&e.groupBy.length>0&&(t.groupBy=e.groupBy.join(","));for(let[r,o]of Object.entries(e))r in t||(typeof o=="string"||typeof o=="number"||typeof o=="boolean"?t[r]=String(o):t[r]=JSON.stringify(o));return t},re=(e,t)=>{if(e.length===0)throw new Error(t)},oe=(e,t)=>{if(ee(String(e)))throw new Error(t)},ie=(e,t)=>()=>(re(String(e),"Collection cannot be empty"),oe(e,"Cannot use readItems for core collections"),{path:`/items/${e}`,params:t??{},method:"GET"}),ae={},le=(e={})=>t=>{let r={...ae,...e};return{async request(o){let s=o();if(s.headers||(s.headers={}),"Content-Type"in s.headers?s.headers["Content-Type"]==="multipart/form-data"&&delete s.headers["Content-Type"]:s.headers["Content-Type"]="application/json","getToken"in this&&!("Authorization"in s.headers)){let p=await this.getToken();p&&(s.headers.Authorization=`Bearer ${p}`)}let n=H(t.url,s.path,s.params),i={method:s.method??"GET",headers:s.headers??{}};"credentials"in r&&(i.credentials=r.credentials),s.body&&(i.body=s.body),s.onRequest&&(i=await s.onRequest(i)),r.onRequest&&(i=await r.onRequest(i));let d=await Q(n.toString(),i,t.globals.fetch);return"onResponse"in s&&(d=await s.onResponse(d,i)),"onResponse"in e&&(d=await e.onResponse(d,i)),d}}};const ne={class:"iframe-container max-w-100vw shadow-lg rounded-lg bg-cover min-h-60"},de=["src"],ce=["src"],ue={__name:"YoutubeEmbed",props:{video:{type:String}},setup(e){const t=W(!1);return(r,o)=>(c(),f("div",ne,[t.value?(c(),f("iframe",{key:1,class:"overflow-hidden",loading:"lazy",src:`https://www.youtube-nocookie.com/embed/${e.video}`,title:"YouTube video player",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""},null,8,ce)):(c(),f("div",{key:0,class:"flex items-center relative w-full bg-cover cursor-pointer op-80 hover-op-100 transition max-w-100vw",onClick:o[0]||(o[0]=s=>t.value=!0)},[l("img",{class:"w-full",src:`https://img.youtube.com/vi/${e.video}/hqdefault.jpg`},null,8,de),o[1]||(o[1]=l("div",{class:"i-la-play-circle text-xl"},null,-1))]))]))}},N=D(ue,[["__scopeId","data-v-25d3c356"]]),fe={class:"text-2xl"},pe={key:1,class:"flex flex-wrap gap-4 m-4"},he={key:0,class:"bg-light-800 dark-bg-dark-200 rounded-xl shadow-lg p-4 relative flex flex-col gap-4"},ge=["src"],me={class:"text-2xl flex items-baseline gap-4"},ye={class:"text-lg op-80 font-mono"},_e={class:"text-md"},be={key:0,class:"text-md bg-light-900 dark-bg-dark-400 p-4 flex flex-col gap-4"},xe={key:2,class:"flex flex-col gap-4 my-4"},ve={class:"flex-0 text-sm"},we={class:"flex-1 font-bold"},ke={class:"flex-0 op-70 text-sm"},je={class:"text-md max-w-45ch"},Se=["href"],Te=["src"],$e={class:"flex flex-col p-2 gap-2",style:{flex:"10 1 180px"}},Oe={class:"flex items-baseline flex-wrap gap-2"},Re={class:"text-2xl"},Ye={class:"text-sm op-80 font-mono"},Ce={class:"text-md"},Ae={__name:"ProjectEvents",props:{id:{type:String,default:""}},setup(e){const t=e,r=W([]);G(async()=>{try{r.value=await Z("https://db.chromatone.center/").with(X("HDqt6uvSbGyYnL4tdi3jntEHOj7i_aYp")).with(le()).request(ie("events",{filter:{project:{id:{_eq:t.id}}},fields:["*","title","description","cover.id","poster.id"]}))}catch{console.log("Projects fetch failed")}});const o=J(),s=P(()=>o.hash&&r.value.find(n=>n.slug==o.hash.split("#")[1]));return(n,i)=>(c(),f(b,null,[r.value.length?(c(),f("div",{key:0,class:"flex mx-4 items-baseline bg-light-800 dark-bg-dark-800 p-4",onClick:i[0]||(i[0]=d=>_(o).hash="")},[i[1]||(i[1]=l("div",{class:"text-3xl font-bold"},"Events ",-1)),i[2]||(i[2]=l("div",{class:"flex-1"},null,-1)),l("div",fe,u(s.value?"1/":"")+u(r.value.length),1)])):h("",!0),r.value.length?(c(),f("div",pe,[U(F,{name:"fade"},{default:z(()=>{var d,p,m,x,v,w,k,j,S,T,$,O,R,Y,C,M;return[s.value?(c(),f("div",he,[i[4]||(i[4]=l("a",{class:"text-xl absolute top-4 right-4",href:"#"},[l("div",{class:"i-la-times"})],-1)),l("img",{class:"w-full",style:{flex:"1 1 200px",margin:"0em"},src:`https://db.chromatone.center/assets/${((p=(d=s.value)==null?void 0:d.cover)==null?void 0:p.id)||((x=(m=s.value)==null?void 0:m.poster)==null?void 0:x.id)}?width=600`},null,8,ge),l("div",me,u((v=s.value)==null?void 0:v.title),1),l("div",ye,u(_(q)((w=s.value)==null?void 0:w.date,"DD MMMM YYYY")),1),l("div",_e,u((k=s.value)==null?void 0:k.description),1),(j=s.value)!=null&&j.announcement?(c(),f("div",be,u((S=s.value)==null?void 0:S.announcement),1)):h("",!0),(T=s.value)!=null&&T.youtube_video?(c(),E(N,{key:1,video:($=s.value)==null?void 0:$.youtube_video},null,8,["video"])):h("",!0),(O=s.value)!=null&&O.schedule?(c(),f("div",xe,[i[3]||(i[3]=l("div",{class:"text-2xl font-bold"},"Schedule",-1)),(c(!0),f(b,null,B((R=s.value)==null?void 0:R.schedule,a=>{var g;return c(),f("div",{class:"p-2 bg-light-800 dark-bg-dark-600 font-mono flex flex-wrap items-center gap-2",key:a},[l("div",ve,u((g=a==null?void 0:a.time)==null?void 0:g.slice(0,5)),1),l("div",we,u(a==null?void 0:a.activity),1),l("div",ke,u(a==null?void 0:a.duration),1)])}),128))])):h("",!0),l("div",je,u((Y=s.value)==null?void 0:Y.content),1),(C=s.value)!=null&&C.livestream?(c(),E(N,{key:3,video:(M=s.value)==null?void 0:M.livestream},null,8,["video"])):h("",!0)])):(c(!0),f(b,{key:1},B(r.value,a=>{var g,A;return c(),f("a",{class:"no-underline bg-light-700 shadow-lg dark-bg-dark-200 flex flex-wrap gap-1",key:a==null?void 0:a.slug,href:`#${a==null?void 0:a.slug}`,style:{flex:"1 1 420px"}},[l("img",{class:"max-h-200px",style:{flex:"1 1 200px",margin:".5em"},src:`https://db.chromatone.center/assets/${((g=a==null?void 0:a.cover)==null?void 0:g.id)||((A=a==null?void 0:a.poster)==null?void 0:A.id)}?width=200&height=200`},null,8,Te),l("div",$e,[l("div",Oe,[l("div",Re,u(a==null?void 0:a.title),1),l("div",Ye,u(_(q)(a==null?void 0:a.date,"DD MMMM YYYY")),1)]),l("div",Ce,u(a==null?void 0:a.description),1)])],8,Se)}),128))]}),_:1})])):h("",!0)],64))}};export{Ae as default};
